!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/du-factory-generator/",r(r.s=0)}([function(e,t,r){"use strict";var n;function i(e,t){return{type:n.OTHER,name:e,volume:t}}function o(e,t){return{type:n.MACHINE,name:e,volume:t}}function s(e){return{type:n.ORE,name:e,volume:1}}function u(e){return e.type===n.ORE}r.r(t),function(e){e.MACHINE="machine",e.CONTAINER="container",e.ORE="ore",e.OTHER="product"}(n||(n={}));const c={vertical_booster_l:i("Vertical booster L",562.4),adjuster_l:i("Adjuster L",619.2),retro_rocket_brake_l:i("Retro-rocket brake L",562.4),atmospheric_airbrake_l:i("Atmospheric airbrake L",619.2),basic_hydraulics:i("Basic hydraulics",10),basic_mobile_panel_m:i("Basic mobile panel M",259.2),basic_standard_frame_m:i("Basic standard frame M",74),basic_pipe:i("Basic pipe",1),basic_screw:i("Basic screw",1),basic_burner:i("Basic burner",10),basic_ionic_chamber_m:i("Basic ionic chamber M",202.4),basic_connector:i("Basic connector",.8),basic_injector:i("Basic injector",10),basic_gaz_cylinder_m:i("Basic gaz cylinder M",259.2),al_fe_alloy:i("Al-Fe alloy",1),silumin:i("Silumin",1),steel:i("Steel",1),polycarbonate_plastic:i("Polycarbonate plastic",1),pure_aluminium:i("Pure aluminium",1),pure_silicon:i("Pure silicon",1),pure_iron:i("Pure iron",1),pure_carbon:i("Pure carbon",1),pure_oxygen:s("Pure oxygen"),pure_hydrogen:s("Pure hydrogen"),bauxite:s("Bauxite"),quarz:s("Quarz"),hematite:s("Hematite"),coal:s("Coal"),smelter_m:o("Smelter M",499.2),refiner_m:o("Refiner M",479.2),metalwork_industry_m:o("Metalwork industry M",599.2),assembly_line_m:o("Assembly line M",599.2),assembly_line_l:o("Assembly line L",3255.4),chemical_industry_m:o("Chemical industry M",479.2),electronic_industry_m:o("Electronical industry M",459.2),"3d_prnter_m":o("3D printer M",609.2)};function a(e,t){return{item:e,quantity:t}}const f=[{product:a(c.adjuster_l,1),byproducts:[],ingredients:[a(c.basic_pipe,36),a(c.basic_injector,25),a(c.basic_gaz_cylinder_m,1),a(c.basic_standard_frame_m,1)],producedWith:c.assembly_line_m,processingTime:32},{product:a(c.vertical_booster_l,1),byproducts:[],ingredients:[a(c.basic_pipe,36),a(c.basic_injector,25),a(c.basic_ionic_chamber_m,1),a(c.basic_standard_frame_m,1)],producedWith:c.assembly_line_m,processingTime:32},{product:a(c.basic_injector,3),byproducts:[],ingredients:[a(c.polycarbonate_plastic,18),a(c.basic_screw,12)],producedWith:c["3d_prnter_m"],processingTime:3},{product:a(c.polycarbonate_plastic,75),byproducts:[],ingredients:[a(c.pure_carbon,100),a(c.pure_hydrogen,50)],producedWith:c.chemical_industry_m,processingTime:3},{product:a(c.atmospheric_airbrake_l,1),byproducts:[],ingredients:[a(c.basic_pipe,36),a(c.basic_hydraulics,25),a(c.basic_mobile_panel_m,1),a(c.basic_standard_frame_m,1)],producedWith:c.assembly_line_m,processingTime:32},{product:a(c.basic_pipe,10),byproducts:[],ingredients:[a(c.silumin,10)],producedWith:c.metalwork_industry_m,processingTime:2},{product:a(c.basic_hydraulics,3),byproducts:[],ingredients:[a(c.basic_pipe,12),a(c.steel,18)],producedWith:c.metalwork_industry_m,processingTime:3},{product:a(c.basic_mobile_panel_m,1),byproducts:[],ingredients:[a(c.silumin,49),a(c.basic_screw,25)],producedWith:c.metalwork_industry_m,processingTime:9},{product:a(c.basic_screw,10),byproducts:[],ingredients:[a(c.steel,10)],producedWith:c.metalwork_industry_m,processingTime:2},{product:a(c.basic_standard_frame_m,1),byproducts:[],ingredients:[a(c.silumin,74)],producedWith:c.metalwork_industry_m,processingTime:6},{product:a(c.steel,75),byproducts:[],ingredients:[a(c.pure_iron,100),a(c.pure_carbon,50)],producedWith:c.smelter_m,processingTime:3},{product:a(c.silumin,75),byproducts:[],ingredients:[a(c.pure_aluminium,100),a(c.pure_silicon,50)],producedWith:c.smelter_m,processingTime:3},{product:a(c.pure_silicon,360),byproducts:[a(c.pure_oxygen,120)],ingredients:[a(c.quarz,520)],producedWith:c.refiner_m,processingTime:3},{product:a(c.pure_carbon,360),byproducts:[a(c.pure_oxygen,60),a(c.pure_hydrogen,60)],ingredients:[a(c.coal,520)],producedWith:c.refiner_m,processingTime:3},{product:a(c.pure_aluminium,360),byproducts:[a(c.pure_hydrogen,120)],ingredients:[a(c.bauxite,520)],producedWith:c.refiner_m,processingTime:3},{product:a(c.pure_iron,360),byproducts:[a(c.pure_oxygen,120)],ingredients:[a(c.hematite,520)],producedWith:c.refiner_m,processingTime:3},{product:a(c.al_fe_alloy,75),byproducts:[],ingredients:[a(c.pure_aluminium,100),a(c.pure_carbon,50)],producedWith:c.smelter_m,processingTime:3},{product:a(c.basic_connector,10),byproducts:[],ingredients:[a(c.al_fe_alloy,10)],producedWith:c.electronic_industry_m,processingTime:2},{product:a(c.basic_ionic_chamber_m,1),byproducts:[],ingredients:[a(c.steel,49),a(c.basic_connector,25)],producedWith:c.metalwork_industry_m,processingTime:9},{product:a(c.basic_burner,3),byproducts:[],ingredients:[a(c.silumin,18),a(c.basic_screw,12)],producedWith:c.metalwork_industry_m,processingTime:3},{product:a(c.retro_rocket_brake_l,1),byproducts:[],ingredients:[a(c.basic_screw,36),a(c.basic_burner,25),a(c.basic_ionic_chamber_m,1),a(c.basic_standard_frame_m,1)],producedWith:c.assembly_line_m,processingTime:32},{product:a(c.basic_gaz_cylinder_m,1),byproducts:[],ingredients:[a(c.silumin,49),a(c.basic_screw,25)],producedWith:c.metalwork_industry_m,processingTime:9}];function d(e){const t=f.find(t=>t.product.item===e);if(t)return t;throw new Error(`No recipe found for product "${e.name}".`)}class p{constructor(e){this.item=e,this.dependencies=new Set,this.dependents=new Set}dependsOn(e){this.dependencies.add(e),e.dependents.add(this)}destroy(){for(const e of this.dependents)e.dependencies.delete(this);for(const e of this.dependencies)e.dependents.delete(this)}}function l(e){const t=function(e){const t=new Map,r=new Set(e);for(const e of r){if(u(e))continue;t.has(e)||t.set(e,new p(e));const n=t.get(e),i=d(e);for(const e of[...i.ingredients,...i.byproducts]){t.has(e.item)||t.set(e.item,new p(e.item));t.get(e.item).dependsOn(n)}i.ingredients.forEach(e=>r.add(e.item))}return t}(e),r=[],n=Array.from(e).map(e=>t.get(e)),i=new Set(n);for(const e of i){i.delete(e);for(const t of e.dependencies)i.add(t);if(0===e.dependencies.size){r.push(e.item);for(const t of e.dependents)i.add(t);e.destroy()}}return r}class m{constructor(){this.producers=new Set,this.consumers=new Set}get incomingLinkCount(){return this.producers.size}get outgoingLinkCount(){return this.consumers.size}static is(e){return e instanceof m}getIngress(e){return Array.from(this.producers).map(t=>t.getOutput(e)).reduce((e,t)=>e+t,0)}getEgress(e){return Array.from(this.consumers).map(t=>t.getIntakeFrom(this,e)).reduce((e,t)=>e+t,0)}}class h{constructor(e,t){this.recipe=e,this.utilization=t,this.inputs=new Map,this.output=void 0}static is(e){return e instanceof h}takeFrom(e,t){this.inputs.set(t,e),e.consumers.add(this)}outputInto(e){this.output&&this.output.producers.delete(this),this.output=e,e.producers.add(this)}getIntake(e){let t=0;for(const r of this.recipe.ingredients)r.item===e&&(t+=r.quantity);return this.utilization*t/this.recipe.processingTime}getIntakeFrom(e,t){return this.inputs.get(t)!==e?0:this.getIntake(t)}getOutput(e){let t=0;for(const r of[...this.recipe.byproducts,this.recipe.product])r.item===e&&(t+=r.quantity);return this.utilization*t/this.recipe.processingTime}}class y extends Set{get machines(){return new Set(Array.from(this).filter(h.is))}get containers(){return new Set(Array.from(this).filter(m.is))}getConsumers(e){return new Set(Array.from(this.machines).filter(t=>t.recipe.ingredients.some(t=>t.item===e)))}getContainers(e){return new Set(Array.from(this.containers).filter(t=>t.getEgress(e)>0||t.getIngress(e)>0))}}function _(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function b(e){return!!e&&!!e[ue]}function g(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype}(e)||Array.isArray(e)||!!e[se]||!!e.constructor[se]||M(e)||j(e))}function v(e,t,r){void 0===r&&(r=!1),0===w(e)?(r?Object.keys:ae)(e).forEach((function(n){r&&"symbol"==typeof n||t(n,e[n],e)})):e.forEach((function(r,n){return t(n,r,e)}))}function w(e){var t=e[ue];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:M(e)?2:j(e)?3:0}function O(e,t){return 2===w(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function P(e,t){return 2===w(e)?e.get(t):e[t]}function A(e,t,r){var n=w(e);2===n?e.set(t,r):3===n?(e.delete(t),e.add(r)):e[t]=r}function k(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function M(e){return re&&e instanceof Map}function j(e){return ne&&e instanceof Set}function S(e){return e.o||e.t}function T(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=fe(e);delete t[ue];for(var r=ae(t),n=0;n<r.length;n++){var i=r[n],o=t[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function x(e,t){E(e)||b(e)||!g(e)||(w(e)>1&&(e.set=e.add=e.clear=e.delete=C),Object.freeze(e),t&&v(e,(function(e,t){return x(t,!0)}),!0))}function C(){_(2)}function E(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function I(e){var t=de[e];return t||_(19,e),t}function W(e,t){de[e]=t}function z(){return ee}function D(e,t){t&&(I("Patches"),e.u=[],e.s=[],e.v=t)}function F(e){q(e),e.p.forEach(N),e.p=null}function q(e){e===ee&&(ee=e.l)}function R(e){return ee={p:[],l:ee,h:e,m:!0,_:0}}function N(e){var t=e[ue];0===t.i||1===t.i?t.j():t.g=!0}function B(e,t){t._=t.p.length;var r=t.p[0],n=void 0!==e&&e!==r;return t.h.O||I("ES5").S(t,e,n),n?(r[ue].P&&(F(t),_(4)),g(e)&&(e=L(t,e),t.l||H(t,e)),t.u&&I("Patches").M(r[ue],e,t.u,t.s)):e=L(t,r,[]),F(t),t.u&&t.v(t.u,t.s),e!==oe?e:void 0}function L(e,t,r){if(E(t))return t;var n=t[ue];if(!n)return v(t,(function(i,o){return K(e,n,t,i,o,r)}),!0),t;if(n.A!==e)return t;if(!n.P)return H(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var i=4===n.i||5===n.i?n.o=T(n.k):n.o;v(3===n.i?new Set(i):i,(function(t,o){return K(e,n,i,t,o,r)})),H(e,i,!1),r&&e.u&&I("Patches").R(n,r,e.u,e.s)}return n.o}function K(e,t,r,n,i,o){if(b(i)){var s=L(e,i,o&&t&&3!==t.i&&!O(t.D,n)?o.concat(n):void 0);if(A(r,n,s),!b(s))return;e.m=!1}if(g(i)&&!E(i)){if(!e.h.N&&e._<1)return;L(e,i),t&&t.A.l||H(e,i)}}function H(e,t,r){void 0===r&&(r=!1),e.h.N&&e.m&&x(t,r)}function $(e,t){var r=e[ue];return(r?S(r):e)[t]}function U(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function J(e){e.P||(e.P=!0,e.l&&J(e.l))}function G(e){e.o||(e.o=T(e.t))}function Q(e,t,r){var n=M(t)?I("MapSet").T(t,r):j(t)?I("MapSet").F(t,r):e.O?function(e,t){var r=Array.isArray(e),n={i:r?1:0,A:t?t.A:z(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=n,o=pe;r&&(i=[n],o=le);var s=Proxy.revocable(i,o),u=s.revoke,c=s.proxy;return n.k=c,n.j=u,c}(t,r):I("ES5").J(t,r);return(r?r.A:z()).p.push(n),n}function V(e){return b(e)||_(22,e),function e(t){if(!g(t))return t;var r,n=t[ue],i=w(t);if(n){if(!n.P&&(n.i<4||!I("ES5").K(n)))return n.t;n.I=!0,r=X(t,i),n.I=!1}else r=X(t,i);return v(r,(function(t,i){n&&P(n.t,t)===i||A(r,t,e(i))})),3===i?new Set(r):r}(e)}function X(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return T(e)}function Y(){function e(e,t){function r(){this.constructor=e}i(e,t),e.prototype=(r.prototype=t.prototype,new r)}function t(e){e.o||(e.D=new Map,e.o=new Map(e.t))}function r(e){e.o||(e.o=new Set,e.t.forEach((function(t){if(g(t)){var r=Q(e.A.h,t,e);e.p.set(t,r),e.o.add(r)}else e.o.add(t)})))}function n(e){e.g&&_(3,JSON.stringify(S(e)))}var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},o=function(){function r(e,t){return this[ue]={i:2,l:t,A:t?t.A:z(),P:!1,I:!1,o:void 0,D:void 0,t:e,k:this,C:!1,g:!1},this}e(r,Map);var i=r.prototype;return Object.defineProperty(i,"size",{get:function(){return S(this[ue]).size}}),i.has=function(e){return S(this[ue]).has(e)},i.set=function(e,r){var i=this[ue];return n(i),S(i).has(e)&&S(i).get(e)===r||(t(i),J(i),i.D.set(e,!0),i.o.set(e,r),i.D.set(e,!0)),this},i.delete=function(e){if(!this.has(e))return!1;var r=this[ue];return n(r),t(r),J(r),r.D.set(e,!1),r.o.delete(e),!0},i.clear=function(){var e=this[ue];return n(e),t(e),J(e),e.D=new Map,v(e.t,(function(t){e.D.set(t,!1)})),e.o.clear()},i.forEach=function(e,t){var r=this;S(this[ue]).forEach((function(n,i){e.call(t,r.get(i),i,r)}))},i.get=function(e){var r=this[ue];n(r);var i=S(r).get(e);if(r.I||!g(i))return i;if(i!==r.t.get(e))return i;var o=Q(r.A.h,i,r);return t(r),r.o.set(e,o),o},i.keys=function(){return S(this[ue]).keys()},i.values=function(){var e,t=this,r=this.keys();return(e={})[ce]=function(){return t.values()},e.next=function(){var e=r.next();return e.done?e:{done:!1,value:t.get(e.value)}},e},i.entries=function(){var e,t=this,r=this.keys();return(e={})[ce]=function(){return t.entries()},e.next=function(){var e=r.next();if(e.done)return e;var n=t.get(e.value);return{done:!1,value:[e.value,n]}},e},i[ce]=function(){return this.entries()},r}(),s=function(){function t(e,t){return this[ue]={i:3,l:t,A:t?t.A:z(),P:!1,I:!1,o:void 0,t:e,k:this,p:new Map,g:!1,C:!1},this}e(t,Set);var i=t.prototype;return Object.defineProperty(i,"size",{get:function(){return S(this[ue]).size}}),i.has=function(e){var t=this[ue];return n(t),t.o?!!t.o.has(e)||!(!t.p.has(e)||!t.o.has(t.p.get(e))):t.t.has(e)},i.add=function(e){var t=this[ue];return n(t),this.has(e)||(r(t),J(t),t.o.add(e)),this},i.delete=function(e){if(!this.has(e))return!1;var t=this[ue];return n(t),r(t),J(t),t.o.delete(e)||!!t.p.has(e)&&t.o.delete(t.p.get(e))},i.clear=function(){var e=this[ue];return n(e),r(e),J(e),e.o.clear()},i.values=function(){var e=this[ue];return n(e),r(e),e.o.values()},i.entries=function(){var e=this[ue];return n(e),r(e),e.o.entries()},i.keys=function(){return this.values()},i[ce]=function(){return this.values()},i.forEach=function(e,t){for(var r=this.values(),n=r.next();!n.done;)e.call(t,n.value,n.value,this),n=r.next()},t}();W("MapSet",{T:function(e,t){return new o(e,t)},F:function(e,t){return new s(e,t)}})}var Z,ee,te="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),re="undefined"!=typeof Map,ne="undefined"!=typeof Set,ie="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,oe=te?Symbol.for("immer-nothing"):((Z={})["immer-nothing"]=!0,Z),se=te?Symbol.for("immer-draftable"):"__$immer_draftable",ue=te?Symbol.for("immer-state"):"__$immer_state",ce="undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator",ae="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,fe=Object.getOwnPropertyDescriptors||function(e){var t={};return ae(e).forEach((function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)})),t},de={},pe={get:function(e,t){if(t===ue)return e;var r=S(e);if(!O(r,t))return function(e,t,r){var n,i=U(t,r);return i?"value"in i?i.value:null===(n=i.get)||void 0===n?void 0:n.call(e.k):void 0}(e,r,t);var n=r[t];return e.I||!g(n)?n:n===$(e.t,t)?(G(e),e.o[t]=Q(e.A.h,n,e)):n},has:function(e,t){return t in S(e)},ownKeys:function(e){return Reflect.ownKeys(S(e))},set:function(e,t,r){var n=U(S(e),t);if(null==n?void 0:n.set)return n.set.call(e.k,r),!0;if(e.D[t]=!0,!e.P){if(k(r,$(S(e),t))&&(void 0!==r||O(e.t,t)))return!0;G(e),J(e)}return e.o[t]=r,!0},deleteProperty:function(e,t){return void 0!==$(e.t,t)||t in e.t?(e.D[t]=!1,G(e),J(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var r=S(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},defineProperty:function(){_(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){_(12)}},le={};v(pe,(function(e,t){le[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),le.deleteProperty=function(e,t){return pe.deleteProperty.call(this,e[0],t)},le.set=function(e,t,r){return pe.set.call(this,e[0],t,r,e[0])};var me=new(function(){function e(e){this.O=ie,this.N=!1,"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}var t=e.prototype;return t.produce=function(e,t,r){if("function"==typeof e&&"function"!=typeof t){var n=t;t=e;var i=this;return function(e){var r=this;void 0===e&&(e=n);for(var o=arguments.length,s=Array(o>1?o-1:0),u=1;u<o;u++)s[u-1]=arguments[u];return i.produce(e,(function(e){var n;return(n=t).call.apply(n,[r,e].concat(s))}))}}var o;if("function"!=typeof t&&_(6),void 0!==r&&"function"!=typeof r&&_(7),g(e)){var s=R(this),u=Q(this,e,void 0),c=!0;try{o=t(u),c=!1}finally{c?F(s):q(s)}return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return D(s,r),B(e,s)}),(function(e){throw F(s),e})):(D(s,r),B(o,s))}if(!e||"object"!=typeof e){if((o=t(e))===oe)return;return void 0===o&&(o=e),this.N&&x(o,!0),o}_(21,e)},t.produceWithPatches=function(e,t){var r,n,i=this;return"function"==typeof e?function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return i.produceWithPatches(t,(function(t){return e.apply(void 0,[t].concat(n))}))}:[this.produce(e,t,(function(e,t){r=e,n=t})),r,n]},t.createDraft=function(e){g(e)||_(8),b(e)&&(e=V(e));var t=R(this),r=Q(this,e,void 0);return r[ue].C=!0,q(t),r},t.finishDraft=function(e,t){var r=(e&&e[ue]).A;return D(r,t),B(void 0,r)},t.setAutoFreeze=function(e){this.N=e},t.setUseProxies=function(e){e&&!ie&&_(20),this.O=e},t.applyPatches=function(e,t){var r;for(r=t.length-1;r>=0;r--){var n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}var i=I("Patches").$;return b(e)?i(e,t):this.produce(e,(function(e){return i(e,t.slice(r+1))}))},e}()),he=me.produce;me.produceWithPatches.bind(me),me.setAutoFreeze.bind(me),me.setUseProxies.bind(me),me.applyPatches.bind(me),me.createDraft.bind(me),me.finishDraft.bind(me);function ye(e,t){for(const r of e.getConsumers(t)){const n=new m;e.add(n),r.takeFrom(n,t)}}function _e(e,t){const r=d(t),n=function(e,t,r,n,i,o){let s=n,u=e,c=r(u),a=u,f=c;for(let e=n;e>i;e=o(e)){let e=t(u),n=r(e);(n<c||Math.exp((c-n)/s)>Math.random())&&(u=e,c=n,n<f&&(a=e,f=n))}return a}(function(e,t){const r=e.getConsumers(t),n=e.getContainers(t),i=Array.from(n).map(e=>({containerExistsAlready:!0,container:e,futureConsumers:new Set})),o=Array.from(r).map(e=>({containerExistsAlready:!1,container:new m,futureConsumers:new Set([e])}));return[...i,...o]}(e,t),function(e){return he(t=>{const r=function(e){const t=be(e.filter(e=>e.futureConsumers.size>0));if(!t)return;const r=be(Array.from(t.futureConsumers));return t.futureConsumers.delete(r),r}(t);r&&function(e,t,r){const n=r.product.item,i=r.product.quantity/r.processingTime,o=be(e.filter(e=>{const r=1+e.container.outgoingLinkCount+e.futureConsumers.size,o=e.container.getIngress(n)-e.container.getEgress(n)-(t.getIntake(n)+Array.from(e.futureConsumers).map(e=>e.getIntake(n)).reduce((e,t)=>e+t,0)),s=Math.ceil(Math.max(0,-o/i)),u=e.container.incomingLinkCount+s;return r<=10&&u<=10}));if(!o)return;o.futureConsumers.add(t)}(t,r,e)})}(r),function(e){const t=e.product.item,r=e.product.quantity/e.processingTime;return e=>{let n=0;for(const i of e){i.futureConsumers.size>0&&!i.containerExistsAlready&&n++;const e=-(i.container.getIngress(t)-i.container.getEgress(t)-Array.from(i.futureConsumers).map(e=>e.getIntake(t)).reduce((e,t)=>e+t,0))/r;n+=e>0?Math.ceil(e):-e}return n}}(r),15,.001,e=>e-.001);for(const i of n){if(0===i.futureConsumers.size)continue;e.add(i.container);for(const e of i.futureConsumers)e.takeFrom(i.container,t);const n=i.container.getIngress(t)-i.container.getEgress(t),o=Math.max(0,-n/(r.product.quantity/r.processingTime)),s=Math.ceil(o);for(let t=0;t<s;t++){const t=new h(r,o/s);e.add(t),t.outputInto(i.container)}}}function be(e){if(0!==e.length)return e[Math.floor(Math.random()*e.length)]}class ge extends Map{constructor(e){super(),e&&this.add(e)}add(e,t){if(e instanceof ge)for(const[t,r]of e.entries())this.add(t,r);else this.has(e)?this.set(e,this.get(e)+t):this.set(e,t)}set(e,t){if(t<0)throw new Error(`Throughput may not be less than 0. Was ${t}/min.`);return 0===t?this.delete(e):super.set(e,t),this}covers(e,t){return e instanceof ge?Array.from(e.entries()).every(([e,t])=>this.covers(e,t)):this.has(e)&&this.get(e)>=t}subtract(e,t){if(e instanceof ge){const t=new ge;for(const[r,n]of e.entries())t.add(r,this.subtract(r,n));return t}{const r=(this.get(e)||0)-t;return r<0?(this.delete(e),-r):(this.set(e,r),0)}}}function ve(e,t){const r=new ge;for(const[n,i]of e.entries())if(!u(n)){const e=d(n);for(const n of t(e)){const t=n.quantity/e.product.quantity*i;r.add(n.item,t)}}return r}function we(e,t){e=new ge(e);const r=new ge;let n=t;for(;n.size>0;){const t=e.subtract(n);r.add(t),n=ve(t,e=>e.ingredients)}return r}Y(),Object.assign(window,{items:c,buildFactory:function(e){const t=function(e){const t=new y;for(const[r,n]of e)for(let e=0;e<Math.ceil(n);e++){const e=d(r),n=new h(e,1);t.add(n);const i=new m;t.add(i),n.outputInto(i)}return t}(e),r=l(new Set(e.keys()));console.log("Computation plan",r);for(const e of r)console.log("Computing",e),u(e)?ye(t,e):_e(t,e);return t},computeIdealMachineCount:function(e){const t=new Map;for(const[r,n]of e.entries())if(!u(r)){const e=d(r);t.set(r,[e.producedWith.name,n/(e.product.quantity/e.processingTime)])}return t},computeThroughputs:function(e){let t=new ge,r=new ge;for(let n=0;n<1e3;n++){t=we(r,e);const n=ve(t,e=>e.byproducts);if(r.covers(n)&&n.covers(r))break;r=n}return t},ItemsFlow:ge}),console.log("\n%cGenerate a factory (slow): \n\n// produce each item with two assemblers\nconst assemblyMachines = new Map([\n    [items.adjuster_l, 2],\n    [items.vertical_booster_l, 2],\n    [items.retro_rocket_brake_l, 2],\n])\nbuildFactory(assemblyMachines)\n","color: #000099"),console.log("\n%cCompute the minimum number of machines required (fast):\n\nconst requiredOutput = new ItemsFlow()\n// produce at least 2 of each in 32 minutes\nrequiredOutput.add(items.adjuster_l, 2 / 32)\nrequiredOutput.add(items.vertical_booster_l, 2 / 32)\nrequiredOutput.add(items.retro_rocket_brake_l, 2 / 32)\ncomputeIdealMachineCount(computeThroughputs(requiredOutput))\n","color: #880088")}]);
//# sourceMappingURL=main.6b321ede24671e656def.js.map